<!DOCTYPE html>
<html lang="ru/">

<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* {
    margin:  0px;
    padding: 0px;
    border:  0px; 
}

html {
    height: 100%;
    font: 14px Verdana, Arial, Helvetica, sans-serif;
}

body {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}

div {
    text-align: justify;	
}

p {
    padding: 5px;
}

ul {
    padding-left: 20px;
}

li {
    padding-top: 2px;
    padding-bottom: 2px;
}

a, a:link, a:active, a:visited {
   #color: #0000EE;
   color: #0000DD;
   #color: red;
}

.background-header {
    background: #F7F7FF;
}

.background-menu {
    background: #D0E0FF;
}

.background-menu-line {
    background: #90A0C0;
}

.border-color-menu {
    border-color: #90A0C0;
}

.color-menu-item {
    color: #2020A0;
}

.color-menu-item-selected { 
    color: #E78C43; 
}

.background-menu-selected-top { 
    background: #C8D8E8;
}

.border-color-div-source-code {
    border-color: #909090;
}

.color-source-sql-comment {
    color: #008000;
}

.color-source-sql-string {
    color: #800060;
}

.color-source-sql-keyword {
    color: #000080;
}

.color-source-sql-block-border {
    color: #DD0000;
}

.color-source-shell {
    color: green;
}

.background-source-shell {
    background: black;    
}

.color-source-html-tag {
    color: #0000CD;
}

.color-source-html-tag-attrubites {
    color: #B22222;
}

.color-source-html-tag-value {
    color: #008000;
}

.color-source-html-comment {
    color: #808080;
}

.color-source-js-comment {
    color: #008000;
}

.color-source-js-keyword {
    color: #000080;
}

.color-source-js-string {
    color: #800060;
}

.div-page {
    #border: solid 3px red;
    display: flex;
    flex-wrap: nowrap;
}

.div-header-middle {
    #border: solid 3px green;
    display: flex; 
    align-items: center; 
    justify-content: center;
	text-align: center;
}

.div-header-sidebar {
    #border: solid 3px blue;
    display: flex;    
    justify-content: center; 
    align-items: center;
    width: 100%;
} 

.div-content {
    display: flex;
    flex-wrap: nowrap;
    #justify-content: space-evenly; 
    justify-content: space-between;
}

.div-content-panel-left {
    #border: solid 3px green;
    width:     260px;
    min-width: 260px;
    max-width: 260px;
    float: left;
    text-align: left;
    padding-top: 10px;
    padding-bottom: 15px;
} 

.div-content-body {
    #border: solid 3px blue;
    padding: 10px 30px 10px 10px;
    border-left-style: solid;
    border-left-width: 2px;
}

.menu-border-top {
    border-top-style: solid;
    border-top-width: 2px;
} 

.menu-border-left {
    border-left-style: solid;
    border-left-width: 2px;
}

.menu-border-right {
    border-right-style: solid;
    border-right-width: 2px;
}

.menu-border-bottom {
    border-bottom-style: solid;
    border-bottom-width: 2px;
}

.menu-top-item {
    text-decoration: none;
    font-size: larger;
    white-space: nowrap;
}

.menu-top-item-selected {
    font-size: larger;
    font-weight: bold;
    white-space: nowrap;
}

.menu-panel-left-item {
    padding-left: 15px;
    text-decoration: none; 
    font-size: larger;
}

.menu-panel-left-item-selected {
    padding-left: 25px;
    font-size: larger;
    font-weight: bold;
}

.nav-static-line {
    font-size: larger;
    background: #D0E0FF;
}
    
.nav-static-line > ul {
    list-style: none;
    padding: 0px;
}

.nav-static-line > ul > li {
    #border: 2px solid red;
    padding: 0px;
    float: left;    
    position: relative;
    text-align: center;
    text-decoration: none;
}
   
.nav-static-line .item {
    padding: 7px;      
    display: block;
    text-align: center;
    text-decoration: none;
}

.nav-static-line .item-selected {
    font-weight: bold;
}

.nav-mobile {
    margin: 0 auto;
	float: left;
    background: #D0E0FF;
}
   
.nav-mobile ul {
    list-style: none;
    margin: 0 auto;
    padding: 0;
}

.nav-mobile li li {
	width: 160px;
}
   
.nav-mobile > ul > li {
    float: left;
    position: relative;
    text-align: left;
    text-decoration: none;
}

.nav-mobile-group-root {
    display: none;
    position: absolute;
    top: 100%;
}

.nav-mobile li:hover > .nav-mobile-group-root {
    display: block;
}

.nav-mobile-group-child {
	display: none;
	position: absolute;
	left: 100%;
	top: 0;
}
    
.nav-mobile li li:hover > .nav-mobile-group-child-1 {
	display: block;
}

.nav-mobile li li li:hover > .nav-mobile-group-child-2 {
	display: block;
}

.nav-mobile-item {  
    padding: 6px;    
    display: block;
    text-align: left;
    text-decoration: none;
    color: #2020A0;	
}

.nav-mobile-item:hover {
   background: #2F718E;
}

.ul-articles li {
    padding-top: 17px;
}

.div-video-iframe {
    width: 560px;
    height: 315px;
}

.div-source-code {
    #border: solid 3px red;
    overflow:scroll;
    min-width: 95%;
    max-width: 200px;   
    border-style: solid;
    border-width: 1px; 
    padding: 2px 3px; 
    font-family: monospace;
    text-align: left;
}

.table-source-code {
    border-collapse: collapse;
    overflow:scroll;
    min-width: 95%;
    max-width: 200px;   
    vertical-align: middle;
}

.table-source-code th {
    border-style: solid;
    border-width: 1px; 
    border-collapse: collapse;
    padding: 3px;
    font-family: monospace;
    text-align: center;
}

.table-source-code td {
    border-style: solid;
    border-width: 1px; 
    border-collapse: collapse;
    padding: 3px 5px; 
    font-family: monospace;
    text-align: left;
}

.div-download {
    border-style: solid;
    border-width: 1px;  
    text-align: center;
}

.a-download {
    text-decoration: none;
}

.div-documentation-synopsis {
    #border: solid 3px red;
    margin-left:    30px;
    margin-right:    0px; 
    margin-top:      3px;
    margin-bottom:   0px;
}

.div-documentation-desc {
    #border: solid 3px red;
    margin-left:    30px;
    margin-right:  100px; 
    margin-top:      3px;
    margin-bottom:   0px;
}

@media (max-width: 900px) {

    #header-desktop {
        display: none;
    }

    #menu-top-line-1 {
        display: none;
    }

    .div-content-panel-left {
        display: none;
    } 

    .div-content-body {
        border-left-width: 0px;
        padding: 5px;
    }

    .div-video-iframe {
        width: 370px;
        height: 210px;
    }

}

@media not (max-width: 900px) {

    #header-mobile {
        display: none;
    }

}

.button-top {
  display: none; 
  position: fixed;
  right: 10px;
  bottom: 40px;
  cursor: pointer;
  font-size: 18px;
  padding: 5px 8px;
  border-style: solid; 
  border-width: 2px;
}

.button-top-visible {
  display: block;
} 
</style>


<title>PGXLS | Документация</title>
	
</head>
<body>

<div id="header-desktop" class="div-page background-header menu-border-bottom border-color-menu" style="justify-content: center; padding: 10px;">

  <h1>PGXLS | Документация</h1>

</div>


<div class='div-page' style='flex: 1; clear:both;'>

  <div class='div-content-panel-left'>
    

<ul>
<li><a href="#usage_method">Принцип использования</a></li>
<li><a href="#security">Безопасность</a></li>

<li><a href="#add_row">add_row</a></li>
<li><a href="#add_row_texts">add_row_texts</a></li>
<li><a href="#add_sheet">add_sheet</a></li>
<li><a href="#add_sheet_by_query">add_sheet_by_query</a></li>
<li><a href="#alignment_horizontal">alignment_horizontal</a></li>
<li><a href="#alignment_vertical">alignment_vertical</a></li>

<li><a href="#border_line">border_line</a></li>

<li><a href="#clear_file_parts">clear_file_parts</a></li>
<li><a href="#color_by_name">color$[name]</a></li>
<li><a href="#create">create</a></li>

<li><a href="#font_name_by_family">font_name$[family]</a></li>
<li><a href="#format_cell">format_cell</a></li>
<li><a href="#format_row">format_row</a></li>

<li><a href="#get_cell_height">get_cell_height</a></li>
<li><a href="#get_column_name">get_column_name</a></li>
<li><a href="#get_file">get_file</a></li>
<li><a href="#get_file_by_query">get_file_by_query</a></li>
<li><a href="#get_file_parts_query">get_file_parts_query</a></li>
<li><a href="#get_format_code_boolean">get_format_code_boolean</a></li>
<li><a href="#get_format_code_numeric">get_format_code_numeric</a></li>

<li><a href="#merge_cells">merge_cells</a></li>

<li><a href="#next_column">next_column</a></li>

<li><a href="#page_paper_format">page_paper_format</a></li>
<li><a href="#page_orientation">page_orientation</a></li>

<li><a href="#pgxls_version">pgxls_version</a></li>

<li><a href="#put_cell">put_cell</a></li>
<li><a href="#put_cell_type">put_cell_[type]</a></li>

<li><a href="#save_file">save_file</a></li>
<li><a href="#save_file_by_query">save_file_by_query</a></li>

<li><a href="#set_all_format">set_all_format</a></li>
<li><a href="#set_column_current">set_column_current</a></li>
<li><a href="#set_column_format_type">set_column_format_[type]</a></li>

<li><a href="#set_page_paper">set_page_paper</a></li>
<li><a href="#set_page_header">set_page_header</a></li>
<li><a href="#set_page_margins">set_page_margins</a></li>
<li><a href="#set_page_rows_repeat">set_page_rows_repeat</a></li>

<li><a href="#set_row_height">set_row_height</a></li>

<li><a href="#xls">xls</a></li>
</ul>


  </div>

  <div class='div-content-body border-content-body border-color-menu'>
    

<a id="usage_method"></a>
<p style="font-size:larger;"><b>Принцип использования</b></p>
<br>

Для создания файла Excel на процедурном языке PL/pgSQL создается функция, которая выполняет следующее:
определяет документ (<a href="#create">pgxls.create</a>), 
заполняет его (<a href="#add_row">pgxls.add_row</a>, <a href="#put_cell">pgxls.put_cell</a>, <a href="#add_sheet">pgxls.add_sheet</a>),
формирует и возвращает файл (<a href="#get_file">pgxls.get_file</a>).
<br>
<br>
Кол-во столбцов и их ширина определяются при создании документа или добавлении листа.
Для каждого столбца можно переопределить формат в зависимости от типа данных c
помощью процедур <a href="#set_column_format_type">pgxls.set_column_format_[type]</a>.
<br>
<br>
Процедура <a href="#put_cell">pgxls.put_cell</a> устанавливает значение ячейки и формат в зависимости от типа значения (настраивается для столбца),
имеет необязательные параметры для изменения свойств форматирования.
<br>
<br>
Процедуры <a href="#format_cell">pgxls.format_cell</a>, <a href="#format_row">pgxls.format_row</a> и <a href="#format_row">pgxls.format_all</a> изменяют форматирование.
<br>
<br>
Для удобства использования определяется текущий столбец, который сбрасывается при добавлении строки и увеличивается 
при установке значения поля без указания столбца.
При установке значения ячейки с указанием столбца текущий столбец переопределяется на указанный.
При помощи процедур <a href="#set_column_current">pgxls.set_column_current</a> и <a href="#next_column">pgxls.next_column</a> можно изменять текущий столбец.
<br>
<br>
При добавлении строки или листа текущая строка записывается во временную таблицу в виде подготовленной части файла
и не может быть изменена.
Высота строки вычисляется автоматически, но может быть установлена вручную процедурой <a href="#set_row_height">pgxls.set_row_height</a>.
<br>
<br>
Настройка печати позволяет для каждого листа установить формат и ориентацию бумаги, заголовок, повторяющиеся строки ("шапку" таблицы) и отступы.
Выполняется процедурами 
<a href="#set_page_paper">pgxls.set_page_paper</a>,
<a href="#set_page_header">pgxls.set_page_header</a>,
<a href="#set_page_rows_repeat">pgxls.set_page_rows_repeat</a> и 
<a href="#set_page_margins">pgxls.set_page_margins</a>
соответственно.
<br>
<br>
При создании больших файлов для заполнения ячеек необходимо использовать процедуры <a href="#set_cell_type">pgxls.set_cell_[type]</a>
и получать файл частями (<a href="#get_file_parts_query">pgxls.get_file_parts_query</a>).
<br>
<br>
Для создания файла по SQL-запросу создана функция-обертка <a href="#get_file_by_query">pgxls.get_file_by_query</a>,
а для добавления листа - процедура <a href="#add_sheet_by_query">pgxls.add_sheet_by_query</a>.
<br>
<br>
Процедуры-обертки <a href="#save_file">pgxls.save_file</a> и <a href="#save_file_by_query">pgxls.save_file_by_query</a>  
сохраняют документ в файл на сервере, выполняются под суперпользователем.
<br>
<br>
Не разрешается обращение к внутренним полям pgxls.xls и использование процедур и типов, начинающихся с подчеркивания "_" 

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="security"></a>
<p style="font-size:larger;"><b>Безопасность</b></p>
<br>
Хранимые процедуры создаются с правами вызывающего (security invoker), соотвественно, передаваемые через параметры динамические SQL-запросы
вызываются с этими правами.
<br><br>
При необходимости доступа разработчика к сохранению файлов на сервере суперпользователь создает процедуру-обертку
с правами владельца (security definer) и необходимыми проверками.<br>
<br>
Пример:<br>
<div class="div-source-code border-color-div-source-code" style="height: 300px;">
<pre><span class="color-source-sql-comment">-- postgres create wrapper for procedure pgxls.save_file with option security definer and access check,</span>
<span class="color-source-sql-comment">-- grant privilege on wrapper    </span>
<span class="color-source-sql-keyword">create</span> <span class="color-source-sql-keyword">or</span> <span class="color-source-sql-keyword">replace</span> <span class="color-source-sql-keyword">procedure</span> example.save_file_to_share_reports(<span class="color-source-sql-keyword">inout</span> xls pgxls.xls, filename <span class="color-source-sql-keyword">varchar</span>) <span class="color-source-sql-keyword">security</span> <span class="color-source-sql-keyword">definer</span> <span class="color-source-sql-keyword">language</span> plpgsql <span class="color-source-sql-keyword">as</span> &dollar;&dollar;  
<span class="color-source-sql-keyword">begin</span> 
  <span class="color-source-sql-keyword">if</span> filename <span class="color-source-sql-keyword">like</span> <span class="color-source-sql-string">'%/%'</span> <span class="color-source-sql-keyword">then</span>
    <span class="color-source-sql-keyword">raise</span> <span class="color-source-sql-keyword">exception</span> <span class="color-source-sql-string">'File name cannot contain path'</span>;   
  <span class="color-source-sql-keyword">end</span> <span class="color-source-sql-keyword">if</span>;
  <span class="color-source-sql-keyword">call</span> pgxls.save_file(xls, <span class="color-source-sql-string">'/mnt/share/reports/'</span>||filename);
<span class="color-source-sql-keyword">end</span> 
&dollar;&dollar;;
<span class="color-source-sql-keyword">grant</span> <span class="color-source-sql-keyword">execute</span> <span class="color-source-sql-keyword">on</span> <span class="color-source-sql-keyword">procedure</span> example.save_file_to_share_reports <span class="color-source-sql-keyword">to</span> developer_1;

<span class="color-source-sql-comment">-- developer_1 create report and save it using wrapper example.save_file_to_share_reports</span>
<span class="color-source-sql-keyword">create</span> <span class="color-source-sql-keyword">or</span> <span class="color-source-sql-keyword">replace</span> <span class="color-source-sql-keyword">procedure</span> example.my_report() <span class="color-source-sql-keyword">language</span> plpgsql <span class="color-source-sql-keyword">as</span> &dollar;&dollar;
<span class="color-source-sql-keyword">declare</span> 
  xls pgxls.xls; 
<span class="color-source-sql-keyword">begin</span>
  xls := pgxls.<span class="color-source-sql-keyword">create</span>(<span class="color-source-sql-keyword">array</span>[10,10]);   
  <span class="color-source-sql-keyword">call</span> pgxls.put_cell_text(xls, <span class="color-source-sql-string">'My'</span>);      
  <span class="color-source-sql-keyword">call</span> pgxls.put_cell_text(xls, <span class="color-source-sql-string">'Report'</span>); 
  <span class="color-source-sql-keyword">call</span> example.save_file_to_share_reports(xls, <span class="color-source-sql-string">'MyReport.xlsx'</span>);      
<span class="color-source-sql-keyword">end</span>
&dollar;&dollar;;
<span class="color-source-sql-keyword">call</span> example.my_report();
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="add_row"></a>
<p style="font-size:larger;"><b>pgxls.add_row</b></p>
<br>
Процедура добавляет одну или несколько строк на лист, обнуляет текущий столбец
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">count</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>кол-во строк (необязательный, по умолчанию 1)</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 66px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.add_row(xls);
<span class="color-source-sql-keyword">call</span> pgxls.add_row(xls, 5);
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="add_row_texts"></a>
<p style="font-size:larger;"><b>pgxls.add_row_texts</b></p>
<br>
Процедура добавляет строку с текстовыми значениями, позволяет менять параметры стиля
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">texts</td><td style="width: 5px;"></td><td style="white-space: nowrap;">text[]</td><td style="text-align: center; width: 30px;">-</td><td>значения ячеек</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_bold</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>жирный шрифт (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">fill_foreground_color</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar(6)</td><td style="text-align: center; width: 30px;">-</td><td>цвет заливки в формате &#39;RRGGBB&#39; или &#39;none&#39; (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_horizontal</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.alignment_horizontal</td><td style="text-align: center; width: 30px;">-</td><td>выравнивание по горизонтали (необязательный)</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 66px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.add_row_texts(xls, <span class="color-source-sql-keyword">array</span>[<span class="color-source-sql-string">'ID'</span>,<span class="color-source-sql-string">'Name'</span>]);
<span class="color-source-sql-keyword">call</span> pgxls.add_row_texts(xls, <span class="color-source-sql-keyword">array</span>[<span class="color-source-sql-string">'x'</span>,<span class="color-source-sql-string">'√x'</span>,<span class="color-source-sql-string">'x²'</span>,<span class="color-source-sql-string">'md5(x)'</span>], font_bold=&#62;<span class="color-source-sql-keyword">true</span>, fill_foreground_color=&#62;pgxls.color&dollar;dark_gray(), alignment_horizontal=&#62;<span class="color-source-sql-string">'center'</span>);
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="add_sheet"></a>
<p style="font-size:larger;"><b>pgxls.add_sheet</b></p>
<br>
Процедура добавляет новый лист в документ
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">columns_widths</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int[]</td><td style="text-align: center; width: 30px;">-</td><td>ширины столбцов</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">columns_captions</td><td style="width: 5px;"></td><td style="white-space: nowrap;">text[]</td><td style="text-align: center; width: 30px;">-</td><td>заголовки столбцов (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">name</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar</td><td style="text-align: center; width: 30px;">-</td><td>имя листа (необязательный)</td></tr>
</table>
<br>
Пример использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 48px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.add_sheet(xls, <span class="color-source-sql-keyword">array</span>[10,20], <span class="color-source-sql-keyword">array</span>[<span class="color-source-sql-string">'ID'</span>,<span class="color-source-sql-string">'Name'</span>], <span class="color-source-sql-string">'Sheet2'</span>);
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="add_sheet_by_query"></a>
<p style="font-size:larger;"><b>pgxls.add_sheet_by_query</b></p>
<br>
Процедура добавляет новый лист в документ
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">columns_widths</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int[]</td><td style="text-align: center; width: 30px;">-</td><td>ширины столбцов</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">columns_captions</td><td style="width: 5px;"></td><td style="white-space: nowrap;">text[]</td><td style="text-align: center; width: 30px;">-</td><td>заголовки столбцов (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">name</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar</td><td style="text-align: center; width: 30px;">-</td><td>имя листа (необязательный)</td></tr>
</table>
<br>
Пример использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 48px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.add_sheet_by_query(xls, <span class="color-source-sql-string">'select * from pg_class'</span>, <span class="color-source-sql-string">'Query data'</span>);
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="alignment_horizontal"></a>
<p style="font-size:larger;"><b>pgxls.alignment_horizontal</b></p>
<br>
Тип enum, определяет выравнивание по горизонтали<br>Значения: top,center,bottom,justify,distributed
<br>


<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="alignment_vertical"></a>
<p style="font-size:larger;"><b>pgxls.alignment_vertical</b></p>
<br>
Тип enum, определяет выравнивание по вертикали<br>Значения: top,center,bottom,justify,distributed
<br>


<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="border_line"></a>
<p style="font-size:larger;"><b>pgxls.border_line</b></p>
<br>
Тип enum, определяет внешний вид границы.<br>Значения: none,thin,thick,dashed,dotted,dashDot,dashDotDot,double
<br>



<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="clear_file_parts"></a>
<p style="font-size:larger;"><b>pgxls.clear_file_parts</b></p>
<br>
Процедура удаляет файл из временной таблицы, используется совместно с <a href="#clear_file_parts">pgxls.get_file_parts_query</a>
<br>
<br>
Параметр:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
</table>


<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="color_by_name"></a>
<p style="font-size:larger;"><b>pgxls.color$[name]</b></p>
<br>
Функция возвращает цвет (тип varchar(6)) по названию
<br>
<br>
Параметр:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">name</td><td style="width: 5px;"></td><td style="white-space: nowrap;"></td><td style="text-align: center; width: 30px;">-</td><td>название: light_red,light_green,light_blue,light_gray,dark_red,dark_green,dark_blue,dark_gray</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 66px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.set_cell_font(xls, color=&#62;pgxls.color&dollar;light_red());
<span class="color-source-sql-keyword">call</span> pgxls.set_all_fill(xls, foreground_color=&#62;pgxls.color&dollar;dark_gray());
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="create"></a>
<p style="font-size:larger;"><b>pgxls.create</b></p>
<br>
Функция создает, инициализирует и возращает документ (тип pgxls.xls)
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">columns_widths</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int[]</td><td style="text-align: center; width: 30px;">-</td><td>ширины столбцов</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">columns_captions</td><td style="width: 5px;"></td><td style="white-space: nowrap;">text[]</td><td style="text-align: center; width: 30px;">-</td><td>заголовки столбцов (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">sheet_name</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar</td><td style="text-align: center; width: 30px;">-</td><td>имя листа (необязательный)</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 120px;">
<pre><span class="color-source-sql-keyword">declare</span> 
  xls pgxls.xls; 
<span class="color-source-sql-keyword">begin</span>
  xls := pgxls.<span class="color-source-sql-keyword">create</span>(<span class="color-source-sql-keyword">array</span>[10,20,30], sheet_name=&#62;<span class="color-source-sql-string">'My sheet'</span>);
  xls := pgxls.<span class="color-source-sql-keyword">create</span>(<span class="color-source-sql-keyword">array</span>[15,30,30], <span class="color-source-sql-keyword">array</span>[<span class="color-source-sql-string">'x'</span>,<span class="color-source-sql-string">'√x'</span>,<span class="color-source-sql-string">'x²'</span>], <span class="color-source-sql-string">'Columns'</span>);
</pre>
</div>


<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="font_name_by_family"></a>
<p style="font-size:larger;"><b>pgxls.font_name$[family]</b></p>
<br>
Функция возвращает имя (тип varchar) по семейству шрифта
<br>
<br>
Параметр:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">family</td><td style="width: 5px;"></td><td style="white-space: nowrap;"></td><td style="text-align: center; width: 30px;">-</td><td>семейство шрифта: sans,sans_serif,monospace</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 66px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.set_column_font(xls, 1, <span class="color-source-sql-keyword">name</span>=&#62;pgxls.font_name&dollar;sans_serif(), size=&#62;16);
<span class="color-source-sql-keyword">call</span> pgxls.set_cell_value(xls, 123, font_name=&#62;pgxls.font_name&dollar;monospace());
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="format_cell"></a>
<p style="font-size:larger;"><b>pgxls.format_cell</b></p>
<br>
Процедура форматирует ячейку
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">column_</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>столбец (необязательный, по умолчанию текущий)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">format_code</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar</td><td style="text-align: center; width: 30px;">-</td><td>код формата (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_name</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar</td><td style="text-align: center; width: 30px;">-</td><td>имя шрифта (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_size</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>размер шрифта (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_bold</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>жирный шрифт (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_italic</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>шрифт курсивом (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_underline</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>подчеркнутый шрифт (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_strike</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>зачеркнутый шрифт (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_color</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar(6)</td><td style="text-align: center; width: 30px;">-</td><td>цвет шрифта в формате &#39;RRGGBB&#39; или &#39;auto&#39; (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">border_around</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.border_line</td><td style="text-align: center; width: 30px;">-</td><td>граница всех сторон (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">border_left</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.border_line</td><td style="text-align: center; width: 30px;">-</td><td>граница слева (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">border_top</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.border_line</td><td style="text-align: center; width: 30px;">-</td><td>граница сверху (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">border_right</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.border_line</td><td style="text-align: center; width: 30px;">-</td><td>граница справа (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">border_bottom</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.border_line</td><td style="text-align: center; width: 30px;">-</td><td>граница снизу (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">fill_foreground_color</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar(6)</td><td style="text-align: center; width: 30px;">-</td><td>цвет заливки в формате &#39;RRGGBB&#39; или &#39;none&#39; (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_horizontal</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.alignment_horizontal</td><td style="text-align: center; width: 30px;">-</td><td>выравнивание по горизонтали (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_indent</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>отступ при выравнивании (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_vertical</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.alignment_vertical</td><td style="text-align: center; width: 30px;">-</td><td>выравнивание по вертикали (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_text_wrap</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>перенос текста при выравнивании (необязательный)</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 84px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.format_cell(xls, 2, format_code=&#62;<span class="color-source-sql-string">'dd.mm.yyyy hh:mm'</span>);
<span class="color-source-sql-keyword">call</span> pgxls.format_cell(xls, font_size=&#62;10, font_bold=&#62;<span class="color-source-sql-keyword">true</span>, fill_foreground_color=&#62;<span class="color-source-sql-string">'AA00EE'</span>);
<span class="color-source-sql-keyword">call</span> pgxls.format_cell(xls, border_around=&#62;<span class="color-source-sql-string">'thin'</span>, alignment_horizontal=&#62;<span class="color-source-sql-string">'left'</span>, alignment_indent=&#62;2);
</pre>
</div>


<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="format_row"></a>
<p style="font-size:larger;"><b>pgxls.format_row</b></p>
<br>
Процедура форматирует все ячейки строки
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_name</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar</td><td style="text-align: center; width: 30px;">-</td><td>имя шрифта (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_size</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>размер шрифта (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_bold</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>жирный шрифт (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_color</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar(6)</td><td style="text-align: center; width: 30px;">-</td><td>цвет шрифта в формате &#39;RRGGBB&#39; или &#39;auto&#39; (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">border</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.border_line</td><td style="text-align: center; width: 30px;">-</td><td>граница всех сторон (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">fill_foreground_color</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar(6)</td><td style="text-align: center; width: 30px;">-</td><td>цвет заливки в формате &#39;RRGGBB&#39; или &#39;none&#39; (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_horizontal</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.alignment_horizontal</td><td style="text-align: center; width: 30px;">-</td><td>выравнивание по горизонтали (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_vertical</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.alignment_vertical</td><td style="text-align: center; width: 30px;">-</td><td>выравнивание по вертикали (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_text_wrap</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>перенос текста при выравнивании (необязательный)</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 66px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.format_row(xls, font_size=&#62;10, font_bold=&#62;<span class="color-source-sql-keyword">true</span>, fill_foreground_color=&#62;pgxls.color&dollar;light_green());
<span class="color-source-sql-keyword">call</span> pgxls.format_row(xls, border=&#62;<span class="color-source-sql-string">'thin'</span>, alignment_horizontal=&#62;<span class="color-source-sql-string">'center'</span>);
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="get_cell_height"></a>
<p style="font-size:larger;"><b>pgxls.get_cell_height</b></p>
<br>
Функция возвращает высоту ячейки, обычно используется при явном указании высоты строки при вертикальном объединении ячеек
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">line_count</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>кол-во строк (необязательный, по умолчанию 1)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_size</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>размер шрифта (необязательный)</td></tr>
</table>
<br>
Пример использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 48px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.set_row_height(xls, pgxls.get_cell_height());
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="get_column_name"></a>
<p style="font-size:larger;"><b>pgxls.get_column_name</b></p>
<br>
Функция возвращает высоту ячейки, обычно используется при явном указании высоты строки при вертикальном объединении ячеек
<br>
<br>
Параметр:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">column_</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>столбец</td></tr>
</table>
<br>
Пример использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 48px;">
<pre>column_name := pgxls.get_column_name(5);
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="get_file"></a>
<p style="font-size:larger;"><b>pgxls.get_file</b></p>
<br>
Функция формирует и возвращает файл (тип bytea)
<br>
<br>
Параметр:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
</table>
<br>
Пример использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 48px;">
<pre>return pgxls.get_file(xls);
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="get_file_by_query"></a>
<p style="font-size:larger;"><b>pgxls.get_file_by_query</b></p>
<br>
Функция создает документ с данными по SQL-запросу, формирует и возвращает файл (тип bytea)
<br>
<br>
Параметр:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">query</td><td style="width: 5px;"></td><td style="white-space: nowrap;">text</td><td style="text-align: center; width: 30px;">-</td><td>SQL-запрос</td></tr>
</table>
<br>
Пример использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 48px;">
<pre><span class="color-source-sql-keyword">select</span> pgxls.get_file_by_query(<span class="color-source-sql-string">'select * from pg_class'</span>);
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="get_file_parts_query"></a>
<p style="font-size:larger;"><b>pgxls.get_file_parts_query</b></p>
<br>
Функция формирует файл и возвращает SQL-запрос (тип varchar) для получения файла по частям.Используется при получении больших файлов, после вычитывания файла необходимо вызвать процедуру <a href="#clear_file_parts">pgxls.clear_file_parts</a>
<br>
<br>
Параметр:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
</table>
<br>
Пример использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 48px;">
<pre>return query <span class="color-source-sql-keyword">execute</span> pgxls.get_file_parts_query(xls);
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="get_format_code_boolean"></a>
<p style="font-size:larger;"><b>pgxls.get_format_code_boolean</b></p>
<br>
Функция формирует логический код формата (тип varchar)
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">text_true</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar</td><td style="text-align: center; width: 30px;">-</td><td>текст для истинного значения (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">text_false</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar</td><td style="text-align: center; width: 30px;">-</td><td>текст для ложного значения (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">text_null</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar</td><td style="text-align: center; width: 30px;">-</td><td>текст для неопределенного значения (необязательный)</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 66px;">
<pre>format1 := pgxls.get_format_code_boolean(<span class="color-source-sql-string">'Yes'</span>, <span class="color-source-sql-string">'No'</span>, <span class="color-source-sql-string">'Null'</span>);
format2 := pgxls.get_format_code_boolean(text_true=&#62;<span class="color-source-sql-string">'1'</span>);
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="get_format_code_numeric"></a>
<p style="font-size:larger;"><b>pgxls.get_format_code_numeric</b></p>
<br>
Функция формирует логический код формата (тип varchar)
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">decimal_places</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>кол-во знаков после запятой</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">thousands_separated</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>разделение тысяч (необязательный)</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 66px;">
<pre>format1 := pgxls.get_format_code_numeric(3);
format2 := pgxls.get_format_code_numeric(decimal_places=&#62;0, thousands_separated=&#62;<span class="color-source-sql-keyword">true</span>);
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="merge_cells"></a>
<p style="font-size:larger;"><b>pgxls.merge_cells</b></p>
<br>
Процедура объединяет ячейки
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">column_count</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>кол-во столбцов (необязательный, по умолчанию 1)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">row_count</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>кол-во строк (необязательный, по умолчанию 1)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">column_</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>столбец, с которого начинается объединение (необязательный, по умолчанию текущий)</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 84px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.merge_cells(xls, 5);
<span class="color-source-sql-keyword">call</span> pgxls.merge_cells(xls, row_count=&#62;5);
<span class="color-source-sql-keyword">call</span> pgxls.merge_cells(xls, 4, 4, 6);
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="next_column"></a>
<p style="font-size:larger;"><b>pgxls.next_column</b></p>
<br>
Процедура увеличивает текущий столбец
<br>
<br>
Параметр:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
</table>
<br>
Пример использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 48px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.next_column(xls);
</pre>
</div>


<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="page_paper_format"></a>
<p style="font-size:larger;"><b>pgxls.page_paper_format</b></p>
<br>
Тип enum, определяет формат бумаги.<br>Значения: A3,A4,A5
<br>


<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="page_orientation"></a>
<p style="font-size:larger;"><b>pgxls.page_orientation</b></p>
<br>
Тип enum, определяет ориентацию страницы.<br>Значения: portrait,landscape
<br>


<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="pgxls_version"></a>
<p style="font-size:larger;"><b>pgxls.pgxls_version</b></p>
<br>
Функция возвращает версию инструмента
<br>


<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="put_cell"></a>
<p style="font-size:larger;"><b>pgxls.put_cell</b></p>
<br>
Процедура заполняет ячейку: устанавливает значение и позволяет менять параметры стиля, присваивает значение текущего столбца
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">value</td><td style="width: 5px;"></td><td style="white-space: nowrap;">anyelement</td><td style="text-align: center; width: 30px;">-</td><td>значение</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">column_</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>столбец (необязательный, по умолчанию текущий)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">format_code</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar</td><td style="text-align: center; width: 30px;">-</td><td>код формата (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_name</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar</td><td style="text-align: center; width: 30px;">-</td><td>имя шрифта (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_size</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>размер шрифта (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_bold</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>жирный шрифт (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_italic</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>шрифт курсивом (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_underline</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>подчеркнутый шрифт (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_strike</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>зачеркнутый шрифт (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_color</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar(6)</td><td style="text-align: center; width: 30px;">-</td><td>цвет шрифта в формате &#39;RRGGBB&#39; или &#39;auto&#39; (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">border_around</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.border_line</td><td style="text-align: center; width: 30px;">-</td><td>граница всех сторон (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">border_left</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.border_line</td><td style="text-align: center; width: 30px;">-</td><td>граница слева (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">border_top</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.border_line</td><td style="text-align: center; width: 30px;">-</td><td>граница сверху (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">border_right</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.border_line</td><td style="text-align: center; width: 30px;">-</td><td>граница справа (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">border_bottom</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.border_line</td><td style="text-align: center; width: 30px;">-</td><td>граница снизу (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">fill_foreground_color</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar(6)</td><td style="text-align: center; width: 30px;">-</td><td>цвет заливки в формате &#39;RRGGBB&#39; или &#39;none&#39; (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_horizontal</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.alignment_horizontal</td><td style="text-align: center; width: 30px;">-</td><td>выравнивание по горизонтали (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_indent</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>отступ при выравнивании (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_vertical</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.alignment_vertical</td><td style="text-align: center; width: 30px;">-</td><td>выравнивание по вертикали (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_text_wrap</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>перенос текста при выравнивании (необязательный)</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 102px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.put_cell(xls, 123);
<span class="color-source-sql-keyword">call</span> pgxls.put_cell(xls, now(), 2, format_code=&#62;<span class="color-source-sql-string">'dd.mm.yyyy hh:mm'</span>);
<span class="color-source-sql-keyword">call</span> pgxls.put_cell(xls, <span class="color-source-sql-string">'Hello'</span>::<span class="color-source-sql-keyword">text</span>, font_size=&#62;10, font_bold=&#62;<span class="color-source-sql-keyword">true</span>, fill_foreground_color=&#62;<span class="color-source-sql-string">'AA00AA'</span>);
<span class="color-source-sql-keyword">call</span> pgxls.put_cell(xls, <span class="color-source-sql-keyword">true</span>, border_around=&#62;<span class="color-source-sql-string">'thin'</span>, alignment_horizontal=&#62;<span class="color-source-sql-string">'left'</span>, alignment_indent=&#62;2);
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="put_cell_type"></a>
<p style="font-size:larger;"><b>pgxls.put_cell_[type]</b></p>
<br>
Процедура устанавливет значение ячейки, присваивает значение текущего столбца.<br><br>Используется при создании больших документов, т.к. не требуется проверка типа и изменение стиля. В остальных случая рекомендуется использовать <a href="#put_cell">pgxls.put_cell</a>
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">type</td><td style="width: 5px;"></td><td style="white-space: nowrap;"></td><td style="text-align: center; width: 30px;">-</td><td>тип данных: text,integer,numeric,date,time,timestamp,boolean</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">value</td><td style="width: 5px;"></td><td style="white-space: nowrap;">[type]</td><td style="text-align: center; width: 30px;">-</td><td>значение</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">column_</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>столбец (необязательный, по умолчанию текущий)</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 102px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.put_cell_integer(xls, 123);
<span class="color-source-sql-keyword">call</span> pgxls.put_cell_numeric(xls, 123.4567, 2);
<span class="color-source-sql-keyword">call</span> pgxls.put_cell_text(xls, <span class="color-source-sql-string">'Hello'</span>);
<span class="color-source-sql-keyword">call</span> pgxls.put_cell_boolean(xls, <span class="color-source-sql-keyword">false</span>, column_=&#62;4);
</pre>
</div>


<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="save_file"></a>
<p style="font-size:larger;"><b>pgxls.save_file</b></p>
<br>
Процедура сохраняет документ в файл на сервере, выполняется под суперпользователем (необходимы права на выполнение lo_export)
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">filepath</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar</td><td style="text-align: center; width: 30px;">-</td><td>абсолютный путь к файлу</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 66px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.save_file(xls, <span class="color-source-sql-string">'/tmp/myreport.xlsx'</span>); 
<span class="color-source-sql-keyword">call</span> pgxls.save_file(xls, <span class="color-source-sql-string">'C:\Reports\report1.xlsx'</span>); 
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="save_file_by_query"></a>
<p style="font-size:larger;"><b>pgxls.save_file_by_query</b></p>
<br>
Процедура создает документ по SQL-запросу и сохраняет его в файл на сервере, выполняется под суперпользователем (необходимы права на выполнение lo_export)
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">filepath</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar</td><td style="text-align: center; width: 30px;">-</td><td>абсолютный путь к файлу</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">query</td><td style="width: 5px;"></td><td style="white-space: nowrap;">text</td><td style="text-align: center; width: 30px;">-</td><td>SQL-запрос</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 66px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.save_file_by_query(<span class="color-source-sql-string">'/tmp/pg_class.xlsx'</span>, <span class="color-source-sql-string">'select * from pg_class'</span>); 
<span class="color-source-sql-keyword">call</span> pgxls.save_file_by_query(<span class="color-source-sql-string">'C:\Reports\customers.xlsx'</span>, <span class="color-source-sql-string">'select name,code,is_vip,amount from customers order by name'</span>); 
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="set_all_format"></a>
<p style="font-size:larger;"><b>pgxls.set_all_format</b></p>
<br>
Процедура устанавливает формат ячеек для всех столбцов и всех типов данных
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">column_</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>столбец (необязательный, по умолчанию текущий)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_name</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar</td><td style="text-align: center; width: 30px;">-</td><td>имя шрифта (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_size</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>размер шрифта (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_bold</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>жирный шрифт (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_color</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar(6)</td><td style="text-align: center; width: 30px;">-</td><td>цвет шрифта в формате &#39;RRGGBB&#39; или &#39;auto&#39; (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">border</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.border_line</td><td style="text-align: center; width: 30px;">-</td><td>граница всех сторон (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">fill_foreground_color</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar(6)</td><td style="text-align: center; width: 30px;">-</td><td>цвет заливки в формате &#39;RRGGBB&#39; или &#39;none&#39; (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_horizontal</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.alignment_horizontal</td><td style="text-align: center; width: 30px;">-</td><td>выравнивание по горизонтали (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_vertical</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.alignment_vertical</td><td style="text-align: center; width: 30px;">-</td><td>выравнивание по вертикали (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_text_wrap</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>перенос текста при выравнивании (необязательный)</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 66px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.set_all_format(xls, font_size=&#62;10, font_bold=&#62;<span class="color-source-sql-keyword">true</span>, fill_foreground_color=&#62;pgxls.color&dollar;light_green());
<span class="color-source-sql-keyword">call</span> pgxls.set_all_format(xls, border=&#62;<span class="color-source-sql-string">'thin'</span>, alignment_horizontal=&#62;<span class="color-source-sql-string">'center'</span>);
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="set_column_current"></a>
<p style="font-size:larger;"><b>pgxls.set_column_current</b></p>
<br>
Процедура устанавливет текущий столбец
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">column_</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>столбец</td></tr>
</table>
<br>
Пример использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 48px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.set_column_current(xls, 5);
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="set_column_format_type"></a>
<p style="font-size:larger;"><b>pgxls.set_column_format_[type]</b></p>
<br>
Процедура устанавливет формат ячеек столбца в зависимости от типа данных.<br>Если тип данных не указан (процедура pgxls.set_column_format), то формат устанавливается для всех типов
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">type</td><td style="width: 5px;"></td><td style="white-space: nowrap;"></td><td style="text-align: center; width: 30px;">-</td><td>тип данных: text,integer,numeric,date,time,timestamp,boolean</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">column_</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>столбец (необязательный, по умолчанию текущий)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">format_code</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar</td><td style="text-align: center; width: 30px;">-</td><td>код формата (необязательный, только для процедур с типом)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_name</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar</td><td style="text-align: center; width: 30px;">-</td><td>имя шрифта (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_size</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>размер шрифта (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_bold</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>жирный шрифт (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_italic</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>шрифт курсивом (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_underline</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>подчеркнутый шрифт (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_strike</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>зачеркнутый шрифт (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_color</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar(6)</td><td style="text-align: center; width: 30px;">-</td><td>цвет шрифта в формате &#39;RRGGBB&#39; или &#39;auto&#39; (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">border_around</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.border_line</td><td style="text-align: center; width: 30px;">-</td><td>граница всех сторон (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">border_left</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.border_line</td><td style="text-align: center; width: 30px;">-</td><td>граница слева (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">border_top</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.border_line</td><td style="text-align: center; width: 30px;">-</td><td>граница сверху (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">border_right</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.border_line</td><td style="text-align: center; width: 30px;">-</td><td>граница справа (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">border_bottom</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.border_line</td><td style="text-align: center; width: 30px;">-</td><td>граница снизу (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">fill_foreground_color</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar(6)</td><td style="text-align: center; width: 30px;">-</td><td>цвет заливки в формате &#39;RRGGBB&#39; или &#39;none&#39; (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_horizontal</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.alignment_horizontal</td><td style="text-align: center; width: 30px;">-</td><td>выравнивание по горизонтали (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_indent</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>отступ при выравнивании (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_vertical</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.alignment_vertical</td><td style="text-align: center; width: 30px;">-</td><td>выравнивание по вертикали (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment_text_wrap</td><td style="width: 5px;"></td><td style="white-space: nowrap;">boolean</td><td style="text-align: center; width: 30px;">-</td><td>перенос текста при выравнивании (необязательный)</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 174px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.set_column_format_numeric(xls, font_size=&#62;10, font_bold=&#62;<span class="color-source-sql-keyword">true</span>, fill_foreground_color=&#62;pgxls.color&dollar;light_green());
<span class="color-source-sql-keyword">call</span> pgxls.set_column_format(xls, border_around=&#62;<span class="color-source-sql-string">'thin'</span>, alignment_horizontal=&#62;<span class="color-source-sql-string">'center'</span>);

<span class="color-source-sql-keyword">call</span> pgxls.set_column_format_numeric  (xls, 10, format_code=&#62;<span class="color-source-sql-string">'0.000'</span>);
<span class="color-source-sql-keyword">call</span> pgxls.set_column_format_timestamp(xls, 11, format_code=&#62;<span class="color-source-sql-string">'dd.mm.yyyy hh:mm'</span>);

<span class="color-source-sql-keyword">call</span> pgxls.set_column_format_integer(xls, 10, format_code=&#62;pgxls.get_format_code_numeric(decimal_places=&#62;0, thousands_separated=&#62;<span class="color-source-sql-keyword">true</span>));
<span class="color-source-sql-keyword">call</span> pgxls.set_column_format_boolean(xls, 11, format_code=&#62;pgxls.get_format_code_boolean(<span class="color-source-sql-string">'Yes'</span>, <span class="color-source-sql-string">'No'</span>, <span class="color-source-sql-string">'Null'</span>));
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="set_page_paper"></a>
<p style="font-size:larger;"><b>pgxls.set_page_paper</b></p>
<br>
Процедура устанавливет параметры бумаги: формат и ориентацию
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">format</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.page_paper_format</td><td style="text-align: center; width: 30px;">-</td><td>формат (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">orientation</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.page_orientation</td><td style="text-align: center; width: 30px;">-</td><td>ориентация (необязательный)</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 66px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.set_page_paper(xls, <span class="color-source-sql-string">'A3'</span>, <span class="color-source-sql-string">'portrait'</span>);
<span class="color-source-sql-keyword">call</span> pgxls.set_page_paper(xls, orientation=&#62;<span class="color-source-sql-string">'landscape'</span>); 
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="set_page_header"></a>
<p style="font-size:larger;"><b>pgxls.set_page_header</b></p>
<br>
Процедура устанавливет заголовок страницы
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">header</td><td style="width: 5px;"></td><td style="white-space: nowrap;"> text</td><td style="text-align: center; width: 30px;">-</td><td>текст заголовка, значение null удаляет заголовок</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">alignment</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.alignment_horizontal</td><td style="text-align: center; width: 30px;">-</td><td>расположение по горизонтали: left,center,right (необязательный, по умолчанию right)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_name</td><td style="width: 5px;"></td><td style="white-space: nowrap;">varchar</td><td style="text-align: center; width: 30px;">-</td><td>имя шрифта (необязательный, по умолчанию Arial)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">font_size</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>размер шрифта (необязательный, по умолчанию 6)</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 66px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.set_page_header(xls, <span class="color-source-sql-string">'MyReport, page &P of &N'</span>, alignment=&#62;<span class="color-source-sql-string">'center'</span>, font_size=&#62;12);
<span class="color-source-sql-keyword">call</span> pgxls.set_page_header(xls, <span class="color-source-sql-keyword">null</span>); 
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="set_page_margins"></a>
<p style="font-size:larger;"><b>pgxls.set_page_margins</b></p>
<br>
Процедура устанавливет отступы страницы
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">left_</td><td style="width: 5px;"></td><td style="white-space: nowrap;">numeric</td><td style="text-align: center; width: 30px;">-</td><td>отступ слева (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">top</td><td style="width: 5px;"></td><td style="white-space: nowrap;">numeric</td><td style="text-align: center; width: 30px;">-</td><td>отступ сверху (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">right_</td><td style="width: 5px;"></td><td style="white-space: nowrap;">numeric</td><td style="text-align: center; width: 30px;">-</td><td>отступ справа (необязательный)</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">bottom</td><td style="width: 5px;"></td><td style="white-space: nowrap;">numeric</td><td style="text-align: center; width: 30px;">-</td><td>отступ снизу (необязательный)</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 66px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.set_page_margins(xls, 0.15, 0.2, 0.15, 0.4);
<span class="color-source-sql-keyword">call</span> pgxls.set_page_margins(xls, bottom=&#62;2); 
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="set_page_rows_repeat"></a>
<p style="font-size:larger;"><b>pgxls.set_page_rows_repeat</b></p>
<br>
Процедура устанавливет строки, повторяющиеся на каждой странице
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">row_from</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>номер начальной строки, значение null отменяет повторение строк</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">row_to</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>номер конечной строки (необязательный, по умолчанию row_from)</td></tr>
</table>
<br>
Примеры использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 66px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.set_page_rows_repeat(xls, 1);
<span class="color-source-sql-keyword">call</span> pgxls.set_page_rows_repeat(xls, 3, 5); 
</pre>
</div>

<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="set_row_height"></a>
<p style="font-size:larger;"><b>pgxls.set_row_height</b></p>
<br>
Процедура устанавливет высоту текущей строки
<br>
<br>
Параметры:<br>
<table>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">xls</td><td style="width: 5px;"></td><td style="white-space: nowrap;">pgxls.xls</td><td style="text-align: center; width: 30px;">-</td><td>документ</td></tr>
  <tr><td style="width: 10px;"></td><td style="white-space: nowrap;">height</td><td style="width: 5px;"></td><td style="white-space: nowrap;">int</td><td style="text-align: center; width: 30px;">-</td><td>высота</td></tr>
</table>
<br>
Пример использования:<br>
<div class="div-source-code border-color-div-source-code" style="height: 48px;">
<pre><span class="color-source-sql-keyword">call</span> pgxls.set_row_height(xls, 20);
</pre>
</div>


<div style="height: 25px;"></div>
<div class="background-menu-line" style="width: 100%; height: 2px; padding: 0px; margin-bottom: 15px;"></div>


<a id="xls"></a>
<p style="font-size:larger;"><b>pgxls.xls</b></p>
<br>
Составной тип, содержит информацию по документу
<br>



<br>


  </div>

</div>

</body>
</html>